(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))u(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function u(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}})();const l={mass:1e4,radius:5,vx:0,vy:0,fixed:!1},d={...l},n={mass:document.getElementById("mass"),radius:document.getElementById("radius"),vx:document.getElementById("vx"),vy:document.getElementById("vy"),fixed:document.getElementById("fixed"),count:document.getElementById("star-count"),clearBtn:document.getElementById("clear-btn")},f=(s,t)=>{if(s==="fixed"){d.fixed=t.checked;return}const e=parseFloat(t.value);isNaN(e)?t.classList.add("error"):(t.classList.remove("error"),d[s]=e)},E=()=>{n.mass.value=l.mass.toString(),n.radius.value=l.radius.toString(),n.vx.value=l.vx.toString(),n.vy.value=l.vy.toString(),n.fixed.checked=l.fixed,n.mass.addEventListener("input",()=>f("mass",n.mass)),n.radius.addEventListener("input",()=>f("radius",n.radius)),n.vx.addEventListener("input",()=>f("vx",n.vx)),n.vy.addEventListener("input",()=>f("vy",n.vy)),n.fixed.addEventListener("change",()=>f("fixed",n.fixed)),n.clearBtn.addEventListener("click",()=>{c.fillStyle="#282828",c.fillRect(0,0,m,y),a.length=0,console.log("Clear requested")})},L=s=>{n.count&&(n.count.innerText=s.toString())},h=document.querySelector("#canvas"),c=h.getContext("2d"),m=window.innerWidth,y=window.innerHeight,S=50;let a=[],v=0;w();E();function w(){h.addEventListener("click",s=>g(s.x,s.y)),h.addEventListener("mousemove",s=>{s.altKey&&g(s.x,s.y)}),h.width=m,h.height=y,requestAnimationFrame(p)}function F(){const s=Math.random()*360,t=80+Math.random()*20,e=50+Math.random()*10;return`hsl(${s}, ${t}%, ${e}%)`}function g(s,t){console.log("adding new star");const e=new I(s,t);e.mass=d.mass,e.radius=d.radius,e.isFixed=d.fixed,e.vx=d.vx,e.vy=d.vy,a.push(e)}function p(s){c.fillStyle="rgba(40,40,40,0.08)",c.fillRect(0,0,m,y),v==0&&(v=s);const t=Math.min(s-v,50)/1e3;v=s;for(const e of a)e.computeAcceleration();for(const e of a)e.update(t),e.draw(c);c.font="20px monospace",c.fillStyle="white",a=a.filter(e=>!e.markedForDeletion),L(a.length),requestAnimationFrame(p)}class I{x;y;color=F();vx=0;vy=0;mass=1e3;markedForDeletion=!1;radius=5;isFixed=!1;ax=0;ay=0;constructor(t,e){this.x=t,this.y=e}computeAcceleration(){[this.ax,this.ay]=[0,0];for(const t of a){if(t==this)continue;const[e,u]=t.getGravitationalFieldAt(this.x,this.y);this.ax+=e,this.ay+=u}}update(t){this.isFixed||(this.vx+=this.ax*t,this.vy+=this.ay*t,this.x+=this.vx*t,this.y+=this.vy*t,this.markedForDeletion=this.x<-10*m||this.x>10*m||this.y<-10*y||this.y>10*y)}draw(t){t.fillStyle=this.color,t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.fill()}getGravitationalFieldAt(t,e){const i=this.x-t,r=this.y-e,o=Math.sqrt(i*i+r*r+625);let x=S*this.mass/(o*o);return[x*i/o,x*r/o]}}
